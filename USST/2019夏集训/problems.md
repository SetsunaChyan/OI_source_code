### p1. A Simple Problem On LIS

给定一个长度为 $n$ 的数列 $a$ ，我们等概率地取出任意一个上升子序列，求每个数被选中的概率，对 $998244353$ 取模。

第一行输入一个整数 $n(1 \leq n \leq 5 \times 10^5)$ 表示数列 $a$ 的长度。

接下来一行输入 $n$ 个整数 $a_i(1 \leq a_i \leq 10^9)$。

输出 $n$ 个整数，表示每个数字被选中的概率。

模意义下的除法 $\frac{a}{b}$ ，可以写成 $ab^{-1} (mod\space P)$ ，也就是 $a$ 乘以 $b$ 的逆元。



### p2. A Simple Problem On Intervals

你有 $n$ 个数，不妨记为 $a_1,a_2,\dots ,a_n$，在一开始它们都是 $0$。你需要处理接下来的 $m$ 个毒瘤操作。操作总共有四种类型。

操作一：把从 $a_x$ 到 $a_y$ 的每一个数都加上 $c$。

操作二：把从 $a_x$ 到 $a_y$ 的每一个数都乘上 $c$。

操作三：把从 $a_x$ 到 $a_y$ 的每一个数赋值为 $c$。

操作四：求 $\sum_{i=x}^y a_i^p \ mod\ 10007$。

第一行两个正整数 $n,m(1 \leq n,m \leq 10^5)$ 。

接下来 $m$ 行，每行都是"$1\ x\ y\ c$"或"$2\ x\ y\ c$"或"$3\ x\ y\ c$"或"$4\ x\ y\ p$"中的一种。

约定 $1 \leq x \leq y \leq n,1 \leq c \leq 10^4,1 \leq p \leq 3$。

对于每一个操作四输出一行结果。



