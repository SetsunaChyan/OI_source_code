### p1. A Simple Problem On LIS

给定一个长度为 $n$ 的数列 $a$ ，我们等概率地取出任意一个上升子序列，求每个数被选中的概率，对 $998244353$ 取模。

第一行输入一个整数 $n(1 \leq n \leq 5 \times 10^5)$ 表示数列 $a$ 的长度。

接下来一行输入 $n$ 个整数 $a_i(1 \leq a_i \leq 10^9)$。

输出 $n$ 个整数，表示每个数字被选中的概率。

模意义下的除法 $\frac{a}{b}$ ，可以写成 $ab^{-1} (mod\space P)$ ，也就是 $a$ 乘以 $b$ 的逆元。



### p2. A Simple Problem On Intervals

你有 $n$ 个数，不妨记为 $a_1,a_2,\dots ,a_n$，在一开始它们都是 $0$。你需要处理接下来的 $m$ 个毒瘤操作。操作总共有四种类型。

操作一：把从 $a_x$ 到 $a_y$ 的每一个数都加上 $c$。

操作二：把从 $a_x$ 到 $a_y$ 的每一个数都乘上 $c$。

操作三：把从 $a_x$ 到 $a_y$ 的每一个数赋值为 $c$。

操作四：求 $\sum_{i=x}^y a_i^p \ mod\ 10007$。

第一行两个正整数 $n,m(1 \leq n,m \leq 10^5)$ 。

接下来 $m$ 行，每行都是"$1\ x\ y\ c$"或"$2\ x\ y\ c$"或"$3\ x\ y\ c$"或"$4\ x\ y\ p$"中的一种。

约定 $1 \leq x \leq y \leq n,1 \leq c \leq 10^4,1 \leq p \leq 3$。

对于每一个操作四输出一行结果。



### p3. 射手座之日Ⅱ

电研社社长目前有着 $30000$ 艘独立成列的战舰(编号从 $1$ 开始)，其中第 $i$ 艘战舰在第 $i$ 列。$Nagato$ 能够监听到他发出的合并指令为 $M_{i,j}$，含义为第 $i$ 号战舰所在的整个战舰队列，作为一个整体(头在前尾在后)接至第 $j$ 号战舰所在的战舰队列的尾部。显然战舰队列是由处于同一列的一个或多个战舰组成的。合并指令的执行结果会使队列增大。在他发布命令调动舰队的同时，作为一名泉水指挥官，$Haruhi$ 会发出询问指令 $C_{i,j}$。该指令意思是，询问电脑，电研社社长的第 $i$ 号战舰与第 $j$ 号战舰当前是否在同一列中，如果在同一列中，那么它们之间布置有多少战舰。

最终的决战已经展开，$SOS$ 团的历史又翻过了一页……

第一行有一个整数 $T(1 \leq T \leq 500,000)$ ，表示总共有 $T$ 条指令。

以下有 $T$ 行，每行有一条指令。指令有两种格式：

1. $M_{i,j}$ ： $i$ 和 $j$ 是两个整数 $(1 \le i,j \le 30000)$，表示指令涉及的战舰编号。如果第 $i$ 艘战舰和第 $j$ 艘战舰在合并前已经在同一列内了，那这是他制造的假消息，请你无视它。
2. $C_{i,j}$ ： $i$ 和 $j$ 是两个整数 $(1 \le i,j \le 30000)$，表示指令涉及的战舰编号。该指令是 $Haruhi$ 发布的询问指令。

依次对输入的每一条指令进行分析和处理：

如果是电研社社长发布的舰队调动指令，则表示舰队排列发生了变化，你的程序要注意到这一点，但是不要输出任何信息。

如果是 $Haruhi$ 发布的询问指令，你的程序要输出一行，仅包含一个整数，表示在同一列上，第 $i$ 号战舰与第 $j$号战舰之间布置的战舰数目。如果第 $i$ 号战舰与第 $j$​ 号战舰当前不在同一列上，则输出 $-1$。



### p4. A Simple Problem On Different Numbers

有一个长度 $n$ 的整数序列 $a_1,a_2,\cdots,a_n$ ， 接下来有 $Q$ 次询问。每次询问会询问你一个区间 $[l_i,r_i]$ ，你需要回答在 $a_{l_i},a_{l_i+1},\cdots,a_{r_i}$ 中有多少个不同的数。

第一行一个正整数 $n(1 \leq n \leq 5 \times 10^5)$ 。

第二行 $n$ 个数 $a_i(0 \leq a_i \leq 10^6)$。

第三行一个整数 $Q(1 \leq Q \leq 5 \times 10^5)$ 。

接下来 $Q$ 行，每行两个正整数 $l_i,r_i(1 \leq l_i \leq r_i \leq n)$ ，表示询问的区间。

$Q$ 行，每行一个整数，依次表示询问对应的答案。 



### p5. A Simple Problem On Graph

你有一张含 $n$ 个点和 $m$ 条边的无向图，数据保证没有重边。你能删掉一些点，与这些点相连的边会被一起删去。但是你不能同时删掉相邻的两个点。请问最少要删去几个点使得整张图上不剩一条边。

第一行两个正整数 $n,m(1 \leq n,m \leq 3 \times 10^5)$ 。

接下来 $m$ 行，每行两个整数 $A,B(1 \leq A,B \leq n)$，表示点 $A$ 和点 $B$ 之间有一条边。

如果不存在解则输出 $QAQ$ ，否则输出最少需要删去几个点。