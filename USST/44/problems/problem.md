[TOC]

## C.射手座之日

黑暗的宇宙空间正在我眼前扩散开来。

那是有如戴上眼罩迷失在马头星云的黑暗空间，连一道星光都观测不到的乏味银河，说穿了就是偷工减料的布景。

这时，要是能加点演出就更好了的想法掠过我心头，不过凡事背后都有其成因，就连这个宇宙空间也是。像是预算、技术或时间等诸如此类的原因。

“什么都看不见嘛。”

我开始抱怨。屏幕的色彩从刚才就是清一色的黑，不禁让我怀疑显示器是否故障了。

当我正在思索自己究竟是在这个宇宙空间的哪里徘徊时，虚无的画面下半部突然出现了一个光点，而且开始埋头前进，我终于忍不住向上级陈情。

“喂，春日。要不要退后一点？你的旗舰太超前了。”

“作战参谋，请称呼我阁下。SOS团团长以军阶而言，少说也是上将级的大将之流。是我们当中最伟大的。”

在我回嘴谁是作战参谋谁又是阁下来着之前——

“凉宫阁下，长门情报参谋传来消息，说敌军舰队有可疑行动。请问该如何应对？”

狗腿军师古泉报告军情。春日的回答是：

“没关系，突击就对了！”

春日目前有着 $n$ 艘独立成队的战舰(编号从 $1$ 开始)，春日可以把任意两艘战舰所在的队伍合并(即使它们已经被摧毁了)，古泉也会报告第 $x$ 艘战舰被摧毁。作为一名泉水指挥官，春日想要知道某个时刻某个队伍里存活的战舰的数量。

注意，如果要合并的战舰已经在一个队伍里了，或者报告被摧毁的战舰在此之前已经被摧毁了，那么你可以无视他们的指令。

### INPUT

第一行两个正整数 $n,m (1 \leq n \leq 50000 , 1 \leq m \leq 50000)$ ，表示目前有 $n$ 艘独立成队的战舰，以及春日会发号施令 $m$ 次。

接下来 $m$ 行，每一行至少两个正整数 $op_i,x_i (op_i \in \{ 1,2,3 \} , 1 \leq x_i \leq n)$ 。

如果 $op_i==1$ ，接下来会有一个额外的正整数 $y_i (1 \leq y_i \leq n )$ ，表示春日想要合并 $x_i$ 和 $y_i$ 号战舰所在的队伍。

如果 $op_i==2$ ，表示 $x_i$ 号战舰被摧毁了。

如果 $op_i==3$ ，表示你需要回答春日 $x_i$ 号战舰所在的队伍里还有多少艘存活着。



### OUTPUT

对于每一个询问，输出一行一个整数表示回答。



### SAMPLE INPUT

5 9
1 1 2
1 1 3
3 1
2 2
3 1
1 4 5
2 4
1 2 4
3 5



### SAMPLE OUTPUT

3
2
3



## D.竹叶狂想曲

话说回来，四月份都已经够热了，时值五月份的今天更是热得让人受不了，而且湿气也更重，一再挑动着我的不快指数。上海理工大学廉价的校舍，跟空调之类的高级机械可以说是完全无缘。综合楼的教室简直就像前往灼热地狱的候车室一样，我确信设计者一点居住舒适环境的概念都没有。

一个我熟识的人紧贴在操场门前。我一眼就看出正作势要爬上铁门的娇小人影。

紧贴在门上、回过头来的那张脸，确实比我所认识的SOS团团长来得年幼。但是那双绝对不会错认的眼睛中的光芒，不折不扣就是春日的眼神。即使她是一身T恤配上短裤的轻松打扮，这种印象依然没有什么改变。三年前的现在，春日是国中一年级的学生。

“你是什么人？变态？还是绑架犯？看起来真是可疑。”

朦胧的街灯将四周照得微微发白。我没办法看清楚春日细部的表情，但是还在念国中一年级的春日的眼神，很明显地变成看着可疑人物的色彩。三更半夜企图溜进操场的女孩子，和一个刚刚结束996在校园路上徘徊的我，哪一个比较可疑？我实在不想深入去思考这个问题。

“你才可疑。你在这里干什么？”

“那还用说？当然是非法入侵。”

别这么冠冕堂皇地宣扬自己的犯罪行为。恼羞成怒也要有个限度。

“你来得正好。我虽然不认识你，但是要是你有空的话，就帮我一下忙吧。“ 

她竟然可以这样脸不红、气不喘地，对一个素昧平生的大学生颐指气使，果然是如假包换的春日。要是我第一次遇见这种国中女生的话，我大概会认为她是危险的神经病吧？

幸运的是，我还有别的人可以依靠。没错没错，就是盯着电脑屏幕看的你，这个烂摊子就交给你了！

春日想要你帮忙拿石灰粉划线机在操场上划线，当然你只能乖乖的听她指手画脚咯。



### INPUT

第一行一个正整数 $n (1 \leq n \leq 10^5)$ ，表示春日命令的数量。

接下来 $n$ 行，每行包含至少一个正整数 $op_i \in \{ 1,2,3,4 \}$ ，表示春日第 $i$ 个命令的种类。

如果 $op_i==1$ ，接下来会有四个正整数 ${X1}_i,{Y1}_i,{X2}_i,{Y2}_i$ ，表示春日想要画一条端点分别在 $({X1}_i,{Y1}_i)$ 和 $({X2}_i,{Y2}_i)$ 的线段，保证春日不会想要画一个点。

如果 $op_i==2$ ，接下来会有一个正整数 $X_i$ ，表示需要回答春日"与直线 $X=X_i$ 有公共点的线段的数量"。

如果 $op_i==3$ ，接下来会有一个正整数 $Y_i$ ，表示需要回答春日"与直线 $Y=Y_i$ 有公共点的线段的数量"。

如果 $op_i==4$ ，表示春日想要擦掉最近画的一条线段。(如果没有线条可擦那你就无视她的这个命令)

约定所有的整数满足 $1 \leq x \leq 10^6$ 。



### OUTPUT

对于每一个询问，输出一行一个整数表示回答。



### SAMPLE INPUT

15 
1 2 2 2 8
1 4 2 6 8
1 8 2 6 8
1 5 5 7 5
1 9 2 9 8
1 9 5 12 2
1 9 5 12 8
1 14 2 14 8
1 16 2 16 8
1 19 2 19 8
1 16 2 19 2
1 16 8 19 8
1 21 2 21 8
3 3
2 6

### SAMPLE OUTPUT

9
3



![B](F:\CPP\OI\CF_RJY_LYD\USST\出题板子\44pdf\pics\D.jpg)

样例的第一个询问如图所示



## E.漫无止境的八月

“请问，同样的两周时间，我们循环了多少次？”

长门以平静的表情回答。

“这一次是第一万五千四百九十八次。”

一阵晕眩袭来。

光是注音就用上了九个字的语词，写作数字的话是15498，感觉上就少很多。阿拉伯数字好棒喔。不晓得是谁想出来的，真想给他磕三个响头以示感谢。您真是太厉害了。竟然连这种有了很方便，没有也无所谓，毫无道理可循的无聊玩意都发明得出来。

“同样的两个星期循环了一万几千回。假如自己本身感觉到被困在那样的回圈中，记忆也不断囤积的话，一般人的精神根本无法负荷。至于凉宫同学的记忆，我想应该是清除得比我们还干净才是。”

这种时候，就得跟史上最强的万事通求救了。我向长门确认：“那是真的吗？”

“对。” 长门点了点头。

结论就是。我们明天预定要做的事情，以前早就做过了？前两天的盂兰盆会和捞金鱼都是？

“不见得。” 长门的声音不带一丝感情。“在过去一万五千四百九十七次循环中，凉宫春日采取的行动并不是完全一致。”

她淡淡地看了我一眼后，又继续淡淡地说：“在前一万五千四百九十七次中，没去盂兰盆会的有两次。有去盂兰盆会但没有去捞金鱼的版本共有四百三十七次。到目前为止，市民游泳池每次都有去。有去打工的多达九千零二十五次，但工作事项分为六大类。除了分发气球之外，还有搬货、打收银、发传单、接电话以及模特儿摄影会。其中送气球发生了六千零十一次，重复两种以上的版本是三百六十次。照顺序排列组合的重复版本则有——”

“够了，不用再说了。”  我及时制止了长门，这个计数的工作对于她太残忍了。

还是让莫的感情的你来吧。



### INPUT

(输入较大，请使用较快的读入方式)

第一行三个正整数 $n,m,k(1 \leq n \leq 15498 , 1 \leq m \leq 100 , 1 \leq k \leq 10000)$ ，表示在重复的 $n$ 次八月(正确的说是八月的最后两周)内，每次做了 $m$ 个活动。

接下来 $n$ 行，每行有 $m$ 个正整数，分别表示了这一轮八月内参加的 $m$ 个活动的编号。



### OUTPUT

输出一个整数，表示有多少个八月没有做过编号为 $k$ 的活动。



### SAMPLE INPUT

5 3 2
1 2 3
1 2 3
3 4 5
1 3 4
2 3 4


### SAMPLE OUTPUT

2



## F.雪山症候群

我不知道设局引诱我们来到这栋雪中怪屋的是何许人也，但是我绝对不会原谅害长门发高烧病倒的家伙。也不会让那种恶烂星人称心如意！无论如何，我们都会离开这里。

长门已经克尽她的职责。虽然途中我没看到也没听到，但是自从闯入这个异空间之后，她肯定一直在和看不到的“敌人”作战。她的表情显得比平常更加木然，想必就是那个原因造成的。虽然她战到鞠躬尽瘁，还是为我们开了个小小的风口。那么，接下来就轮到我们自己来打开这扇门了。

“我们要离开这里。”

门上赫然映着三行十进制阿拉伯数字，幸运的是长门告诉了我们解读门密码的规律。

第一行有 $n$ 个互不相同的正整数，记为 $a_1 ... a_n$ 。第二行和第三行分别有 $m$ 个正整数，记为 $b_1 ... b_m$ 和 $c_1 ... c_m$ 。

把 $b_i$ 和 $\{ a_1,...,a_n\}$ 中每个数的异或值算出来，其中第 $c_i$ 小的异或值就是密码的一部分。

然后依次把这 $m$ 个异或值连起来就是密码啦。

救救孩子吧。



### INPUT

第一行两个正整数 $n,m (1 \leq n,m \leq 10000)$，表示这三行数字的个数。

第二行 $n$ 个互不相同的正整数 $a_i (1 \leq a_i \leq 2^{60})$ 。

第三行 $m$ 个正整数 $b_i (1 \leq b_i \leq 2^{60})$ 。

第四行 $m$ 个正整数 $c_i (1 \leq c_i \leq n)$ 。 



### OUTPUT

输出一行字符 $s$ ，表示门的密码。



### SAMPLE INPUT

5 6
1 2 3 4 5
3 4 5 6 5 7
2 2 3 4 2 3



### SAMPLE OUTPUT

114514




## G.神秘信号

难得在我的学习欲望达到最高点的绝佳时机，却被春日拉住袖子，硬是带到计算机中心301室去。

“你看看这个。”

春日边说边指给我看的，是之前从光电楼抢来的电脑屏幕。

我没办法反抗，只好乖乖地看了。绘图软件显示出一些我看不懂的涂鸦。在一个圆圈当中，有一些好像喝醉酒的绦虫蜷曲在一起形成的鬼东西，不知道是图是字还是什么象形文字，看起来就像幼稚园小朋友画出来的东西。

“这是我们SOS团的徽章。”

春日回答，露出完成了伟大成就似的得意表情。

“徽章？”我问道。

“没错，徽章。”春日说。

“这个吗？这种东西看起来就像熬夜一整晚、连续两个月连休假日也要刷题、一直AC不了的ACMer，一边喝小酒解宿醉一边走路留下来的脚印。”

“你看清楚啦！你瞧，正中央不是画了SOS团吗？”

经她这么一说，我仔细一瞧，这个东西不知道是不是心理作用、看起来也不能说不像SOS团、但是又不敢大声肯定是什么东西。以上我到底用了几个否定句呢？我自己是懒得算了，哪个吃饱没事干的人帮我算一下。

“最闲的不就是你吗？反正考试时你也不念书的。”

刚刚我还充满想好好念书的冲劲。不过听她这么一说，事实倒也是这样。

“我想把这个登在SOS团网站的首页。”

经她这么一提，我想起确实是有这个东东。虽然是只有首页的可怜网站。(附上网站地址 http://www.haruhi.tv/ 很遗憾比赛时身处局域网的您并不能看到这一伟大工程)

"你制作的这个网站，真是一点用处都没有，完全没有能够炒热气氛的东西。所以我就想到了，如果贴上SOS团的象征或者1096的照片之类的东西，会不会比较好一点？”

![p1](F:\CPP\OI\CF_RJY_LYD\USST\44\problems\p1.png)

---

春日为了增加社团的热度，打算把 $n$ 张1096的照片放到网站上博人眼球。

但是我是绝对不允许的！况且，服务器还要一边判题，一边承受压力测试，哪有这么多资源给你自由发挥。

在我的强烈反对下，春日只能在满足不超过资源限制的情况下，最多挑 $n$ 张当中的 $m$ 张了。可恶，这根本就是不听取我的意见啊！

还是请你求出网站能获得的最大热度吧。



### INPUT

第一行三个正整数 $n,m,s (1 \leq n \leq 100 , 1 \leq m \leq min(50,n) , 1 \leq s \leq 500 )$ ，分别表示照片总数，最多可选的照片数与服务器可用资源数。

接下来 $n$ 行，每行包含两个正整数 $a_i,b_i (1 \leq a_i \leq 20 , 1 \leq b_i \leq 10^7)$ ，表示第 $i$ 张照片所要消耗的资源和会产生的热度。



### OUTPUT

一个整数表示网站能获得的最大热度。



### SAMPLE INPUT

3 2 10
5 10
6 12
3 1



### SAMPLE OUTPUT

13





## H.Someday in the rain

平凡的日常。

春日不知道用了什么方法获取到了电器街老板们的赞助，电器街上的每一家都答应赠送春日一种电器，还可以选择一家店免费租用他们的仓库。而搬运电器这个光荣的使命自然而然地就落到了你的身上。

你需要选择一家店作为仓库，任务是把所有的电器都搬回仓库，遗憾的是由于电器实在是太沉了，每一次只能搬一台电器。已知电器街所有店之间的道路恰好构成一棵无根树。那么现在任务就变得很简单了，选择哪家电器作为仓库可以使搬完所有电器的路程最短呢(如果有多个店铺满足要求就输出编号最小的，为什么呢，因为我不想写SPJ呀)。



### INPUT

第一行一个正整数 $n (2 \leq n \leq 10^6)$ ，表示电器街上店的数量。

接下来 $n-1$ 行，每行包含三个正整数 $x,y,v (1 \leq x,y \leq n,1 \leq v \leq 10^5)$ ，表示店 $x$ 与店 $y$ 之间有一条长为 $v$ 的道路。



### OUTPUT

第一行一个正整数 $X$ ，表示选择 $X$ 店作为仓库时路程总和最短(有多个 $X$ 时输出最小的那一个)。

第二行一个整数 $S$ ，表示此时的总路程。



### SAMPLE INTPUT

5
1 2 9
1 3 1
3 4 2
3 5 4




### SAMPLE OUTPUT

3
34



![H](F:\CPP\OI\CF_RJY_LYD\USST\出题板子\44pdf\pics\H.jpg)





## I.压力测试 Ⅱ

为了不让 $G$ 题里的春日顺心如意，你需要向服务器发起人工 $DDOS$ ！

本题由 $8$ 个思考题组成，你只需回答对应语句的正确性即可。

1. 扔 $24$ 次一对骰子，出现至少一次双 $6$ 点概率 $P \geq 50\%$ 
2. 一辆平均 $10$ 分钟一班的公交车(比如有时 $5$ 分钟来一班有时 $15$ 分钟来一班，但总体平均 $10$ 分钟一辆)，你来到车站等到下一辆车的平均时间为 $5$ 分钟。
3. 一板 $9*9$ 的巧克力，两人博弈，每次沿着直线掰成两半，吃掉一半，另一半留给对手，谁先没得掰谁输，先手必胜。
4. 一副牌去掉大小王和一张 $3$ 一张 $4$ ，剩余 $50$ 张牌正面朝上排开，两人博弈，每次选一张正面朝上的牌，将他和他后面 $9$ 张牌翻转(不足 $9$ 张则有多少翻多少)，谁先无法操作谁输，先手必胜。
5. $100$ 枚硬币 $99$ 真 $1$ 假，假币可能偏轻也可能偏重，一架普通天平，可以在两边分别放若干枚硬币，观察左重/右重/平，最少需要使用 $2$ 次天平即可确定假币是偏轻还是偏重。
6. 一张理想的(无摩擦力，正常反弹等条件)台球桌上没有洞和其他球。存在一种形状的桌子，可以这张台球桌上找到 $2$ 个区域，使得在一个区域里不管怎么击出球，都无法在有限次反弹后到达第二个区域，反之亦然。
7. 定义密铺：用完全相同的砖块无重叠无缝隙地铺满一个足够大的区域，允许边缘不平整。
   凸 $n$ 边形中，只有 $n=3,4,6$ 时有可以密铺的形状。
8. 一下 $8$ 组 $24$ 点有解

   (1) $2,2,2,9$
   
   (2) $6,9,9,10$
   
   (3) $1,2,7,7$
   
   (4) $3,4,6,10$
   
   (5) $8,8,8,10$
   
   (6) $6,8,8,10$
   
   (7) $5,7,10,10$
   
   (8) $1,3,9,10$



### INPUT

无



### OUTPUT

对于每题输出字母’T’或’F’，表示正确与否



### SAMPLE INPUT

无



### SAMPLE OUTPUT

无可奉告



最多有 $4$ 个命题是错的。